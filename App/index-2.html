<html>

<head>
    <title>Al Rajhi</title>
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container-fluid px-0">
        <a href="index.html">
            <img src="./assets/img/navbar.PNG" alt="navbar" class="navbar">
        </a>
    </div>

    <div class="d-flex justify-content-center">
        <div class="container-fluid px-5 mx-5 form-wrapper mt-5 py-4 px-5 mx-5">
            <ul>
                <li>
                    <a href="http://localhost:3000/template_1.html">Template_1</a>
                </li>
                <li>
                    <a href="http://localhost:3000/template_2.html">Template_2</a>
                </li>
            </ul>
        </div>
    </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.19.3/docxtemplater.js"></script>
<script src="https://unpkg.com/pizzip@3.0.6/dist/pizzip.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
<script src="https://unpkg.com/pizzip@3.0.6/dist/pizzip-utils.js"></script>
<!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
<!--[if IE]>
        <script type="text/javascript" src="https://unpkg.com/pizzip@3.0.6/dist/pizzip-utils-ie.js"></script>
    <![endif]-->
<script>

    // function generate() {
    document.getElementById("appForm").addEventListener("submit", function (event) {
        event.preventDefault();
        var formData = new FormData(document.forms[0])
        fetch('http://localhost:3000/get_report', {
            method: 'post',
            body: JSON.stringify(Object.fromEntries(formData)),
            headers: {
                'Content-Type': 'application/json'
            }
        }).then((res) => {
            return res.json();
        })
            .then((json) => {
                console.log(json);
                window.location = `http://localhost:3000/output_files/${json.name}.docx`
            })
    })
</script>

</html>